name: Prescription WorkFlow

on: push
jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Create Network
        run: docker network create inside
      - name: Build the stack
        run: docker-compose up -d
      - name: Composer install
        run: docker exec -it prescriptions-api composer install
      - name: Copy .env
        run: docker exec -it prescriptions-api php -r "file_exists('.env') || copy('.env.example', '.env');"
      - name: Generate key
        run: docker exec -it prescriptions-api php artisan key:generate
      - name: up service
        run: docker exec -it prescriptions-api php artisan serve --host=0.0.0.0 --port=8000 &